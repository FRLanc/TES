begin 1game_inside_teleportation

;Из расчета на 9 точек!!!

short button
short state

if ( MenuMode == 1 )
	return
endif

if ( GetStandingPC == 0 )
	if ( "1game_on_platform" == 1 )
		set "1game_on_platform" to 0
	endif
endif

if ( state == 0 )
	if ( "1game_on_platform" == 1 )
		return
	endif
	if ( GetStandingPC == 1 )
		if( "1game_ready" == 2 )
			set state to 1
			set "1game_on_platform" to 1
	 	endif
	endif
endif

;Тут происходит выбор вариантов телепортации, который зависит от переменной 1game_opened_room
;1game_opened_room - означает разные наборы точек телепортации: 0 - default, 1 - ...
if ( state == 1 )
	if ( "1game_opened_room" == 0 )
		Messagebox "Доступная телепортация:" "Башня" "Зал телепортации" "Отмена"
		set state to 200
		return
	endif
endif

;вариант 00 - default: 2 точки (совпадают с полным набором) и отмена (не совпадает, надо переназначить)
if ( state == 200 )
	set button to GetButtonPressed
        if ( button == 2 )
        	set button to 10
        endif
        set state to 3
endif

;здесь находится полный набор точек телепортации
if ( state == 3 )
	if ( button == 0 )
        	set "1game_get_teleported" to 1
        	playsound "conjuration hit"
		Player->PositionCell 4041, 4905, 12282, 0 "Гелендорф, Башня"
        elseif ( button == 1 )
         	set "1game_get_teleported" to 1
        	playsound "conjuration hit"
		Player->PositionCell 3958, 3414, 15183, 0 "Гелендорф, Зал Телепортации"
	endif
	set state to 0
	set button to 0
endif

end
