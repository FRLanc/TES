begin 1game_inside_teleport

float timer
short ready
 
if ( MenuMode == 1 )
  return
endif
 
if ( OnActivate == 1 )
  if ( ready == 0 )
    if ( "1game_energy" == 0 )
      messagebox "Ничего не происходит, кажется нет питания"
      return
    elseif ( "1game_energy" == 1 )
      set ready to 1
      return
    endif
  endif
endif
 
if ( ready == 1 )
  set timer to ( timer + GetSecondsPassed )
  if ( timer < 2 )
    if ( CellChanged == 0 )
      if ( GetSoundPlaying "BM pipe large" == 0 )
        PlayLoopSound3DVP "BM pipe large", 1.0, 1.0
      endif
    endif
    move z -50
    rotate z 180
  elseif ( timer < 3 )
    set timer to 0
    set ready to 2
    messagebox "Готов. Для телепортации встаньте на платформу"
    set "1game_ready" to 1
  endif
endif
 
if ( ready == 2 )
  set timer to ( timer + GetSecondsPassed )
  if (timer > 30 )
    set timer to 0
    set ready to 3
  endif
endif

if ( ready == 3 )
  set timer to ( timer + GetSecondsPassed )
  if ( timer < 2 )
    if ( CellChanged == 0 )
      if ( GetSoundPlaying "BM pipe medium" == 0 )
        PlayLoopSound3DVP "BM pipe medium", 1.0, 1.0
      endif
    endif
    move z 50
    rotate z -180
  elseif ( timer < 3 )
    set timer to 0
    set ready to 0
    set "1game_ready" to 0
  endif
endif
 
end
